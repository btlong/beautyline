<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userinfo">

	<!--  리스트 -->
	<select id="listUser" resultType="userinfovo">
		<![CDATA[
			select	no,
					name, 
					phone,
					id, 
					password, 
					email, 
					address, 
					agr_email as agrEmail,
					agr_message as agrMessage,
					is_admin as isAdmin from users
			order by no desc
		]]>
	</select>

	<!-- 회원검색 -->
	<select id="searchUser" parameterType="map" resultType="userinfovo">
		<![CDATA[
			select 	no,
					name, 
					phone,
					id, 
					password, 
					email, 
					address,
					agr_email as agrEmail,
					agr_message as agrMessage, 
					is_admin as isAdmin from users 
			where ${keyfield} like '%${keyword}%' order by no desc
		]]>
	</select>
	
	
	
	<!-- 수정 -->
	<!-- <select id="findByNo" parameterType="Long" resultType="userinfovo">
        select * from users where no = #{no}
    </select> -->

	<!-- 회원삭제 -->
	<delete id="deleteUser" parameterType="java.lang.Long">
		<![CDATA[
			delete from users
			where no=#{no}
		]]>
	</delete>
	
	<!-- 수정폼 -->
 	<select id="selectUser" parameterType="java.lang.Long"
		resultType="userinfovo">
		<![CDATA[
			select no, name, phone, id, email, address, is_admin as isAdmin from users
			where no=#{no}
		]]>
	</select>
 
 	<!-- 수정 -->
	<update id="updateUser" parameterType="userinfovo">
		<![CDATA[
			update users set
				name = #{name},
				phone= #{phone},
				id= #{id}, 
				email= #{email}, 
				address= #{address}, 
				is_admin=  #{isAdmin}
			where no=#{no}
		]]>
				<!-- isAdmin= #{isAdmin} -->
	</update>
	
	
 <!-- 	<select id="couponView" parameterType="java.lang.Long"
		resultType="kr.ac.sungkyul.beautyline.vo.CouponviewVo">
		<![CDATA[
			select users.name as userName, program.name as programName, coupon.count as count
			from users users, program program, coupon coupon
			where coupon.user_no=users.no
			and coupon.program_no = program.no
			and users.no=#{users.no}
		]]>
	</select> -->
	
<!-- 	<select id="listCoupon" resultType="kr.ac.sungkyul.beautyline.vo.CouponviewVo">
		<![CDATA[
			select coupon.no, users.no as userNo, program.no as programNo, coupon.count as count, users.name as userName, program.name as programName
			from users users, program program, coupon coupon
			where coupon.user_no=users.no
			and coupon.program_no = program.no
			and users.no=#{users.no}
		]]>
	</select>
	 -->
</mapper>