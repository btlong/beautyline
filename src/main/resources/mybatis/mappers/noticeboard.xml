<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="noticeboard">

	<!-- 게시판 글쓰기 -->
	<insert id="insert" parameterType="noticeboardvo" >
	<selectKey resultType="java.lang.Long" keyProperty="no" order="BEFORE">
	<![CDATA[
		select seq_bd_noti.nextval as no from DUAL
	]]>
	</selectKey>
	<![CDATA[
		insert into bd_noti values(#{no }, '3', #{category}, #{title }, #{content }, sysdate, '0')
	]]>
	</insert>
	

	
	
	
	<select id="selectFileNotiByNo" parameterType="java.lang.Long" resultType="kr.ac.sungkyul.beautyline.vo.FileNotiVo">
	<![CDATA[
	select no, notice_no as noticeNo, org_name as orgName, path, save_name as saveName from f_noti where notice_no =#{noticeNo }
	]]>
	</select>
	

	


	<select id="getAll" resultType="noticeboardvo">
	<![CDATA[
		select no, category, title, to_char(reg_date,'yyyy-mm-dd') as regDate, view_count as viewCount  from bd_noti order by no desc
	]]>
	</select>


	<select id="view" parameterType="java.lang.Long" resultType="noticeboardvo">
   	<![CDATA[
      select b.no, b.category, b.title, b.content, to_char(reg_date,'yyyy-mm-dd') as regDate, b.view_count as viewCount
       from bd_noti b
       where b.no = #{no }
    	]]>
  	 </select>



	<!-- 파일저장 -->
	<insert id="insertFileNoti" parameterType="kr.ac.sungkyul.beautyline.vo.FileNotiVo">
	
	<![CDATA[
		insert into f_noti values (seq_f_noti.nextVal, #{noticeNo }, #{orgName }, #{path }, #{saveName } )
		]]>
	</insert>

	
	
	
	<!-- 첨부파일 시험 
	
		<select id="selectAttachFileByNo" parameterType="java.lang.Long" resultType="kr.ac.sungkyul.mysite.vo.AttachFileVo">
	<![CDATA[
	select * from bbs_file where no =#{no }
]]>
	</select>
	
	<select id="selectAttachFileByFno" parameterType="java.lang.Long" resultType="kr.ac.sungkyul.mysite.vo.AttachFileVo">
	<![CDATA[
	select * from bbs_file where fno =#{fno }
]]>
	</select>

	
	
	-->

	<!-- 글 수정 -->
	<update id="modify" parameterType="noticeboardvo">
	<![CDATA[
		update bd_noti set 
		category = #{category}, 
		title = #{title },
		content = #{content },
		reg_date = sysdate
		where no = #{no}
	]]>	
	</update>



	<!-- 조회수 업뎃 -->
	<update id="updateviewcnt" parameterType="java.lang.Integer">
	<![CDATA[
		update bd_noti set VIEW_COUNT = VIEW_COUNT+1 where no= #{no }
	]]>
	</update>

	<delete id="delete" parameterType="java.lang.Long">
	<![CDATA[
		delete from BD_NOTI where no = #{no } 
	]]>
	</delete>

	<!-- 파일 삭제 -->
	<delete id="delFile" parameterType="java.lang.Long">
	<![CDATA[
		delete from f_noti where no = #{no }
	]]>
	</delete>

</mapper> 
