<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="res">

<select id="resList" resultType="kr.ac.sungkyul.beautyline.vo.ReserveVo">
	<![CDATA[
		select r.no as no,r.user_no as userNo,u.name as userName,r.prog_name as progName,r.res_date as resDate,r.res_Time as resTime 
		from reservation r, users u where u.no = r.user_no order by resDate desc, resTime desc
	]]>

</select>

<select id="resSelect" parameterType="java.lang.Integer" resultType="kr.ac.sungkyul.beautyline.vo.ReserveVo">

	<![CDATA[
		select r.no as no,r.user_no as userNo,u.name as userName,r.prog_name as progName,r.res_date as resDate,r.res_Time as resTime 
		from reservation r, users u where u.no = r.user_no and r.no = #{no} 
	
	]]>


</select>

<!-- 예약일로 검색해서 list로 돌려주기 -->
<select id="resDaySel" parameterType="java.lang.String" resultType="kr.ac.sungkyul.beautyline.vo.ReserveVo">
	
	<![CDATA[
		select res_time as resTime from reservation where RES_DATE = #{resDateText} order by resTime asc
	]]>

</select>

<!-- <delete id="resDelete" parameterType="java.lang.Integer" resultType="java.lang.Integer">
	<![CDATA[
	
		delete from reservation where no = #{no}
		
	]]>
</delete> -->

<!-- reserveVo 넣기 -->
<insert id="reserve" parameterType="kr.ac.sungkyul.beautyline.vo.ReserveVo">
	<!-- no자동생성 후 no값을 return 한다. insert문은 return 할 수 없다. -->
	<selectKey resultType="java.lang.Integer" keyProperty="no" order="BEFORE">
		SELECT seq_reserve.nextVal as no FROM DUAL
	</selectKey>
	
	<![CDATA[
		insert into reservation (
			no, user_no, prog_name, res_date, res_time
		)
		values( 
			#{no }, #{userNo }, #{progName}, #{resDate }, #{resTime }
		)	

	]]>
</insert>

</mapper>